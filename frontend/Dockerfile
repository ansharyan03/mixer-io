FROM --platform=linux/amd64 node:current-alpine

ARG NEXT_PUBLIC_SUPABASE_URL
ARG NEXT_PUBLIC_SUPABASE_ANON_KEY
ARG SPOTIFY_CLIENT
ARG SPOTIFY_SECRET
ARG NEXT_PUBLIC_BACKEND_URL
ARG NEXT_PUBLIC_TANGLER_URL
ENV NEXT_PUBLIC_SUPABASE_URL=$NEXT_PUBLIC_SUPABASE_URL
ENV NEXT_PUBLIC_SUPABASE_ANON_KEY=$NEXT_PUBLIC_SUPABASE_ANON_KEY
ENV SPOTIFY_CLIENT=$SPOTIFY_CLIENT
ENV SPOTIFY_SECRET=$SPOTIFY_SECRET
ENV NEXT_PUBLIC_BACKEND_URL=$NEXT_PUBLIC_BACKEND_URL
ENV NEXT_PUBLIC_TANGLER_URL=$NEXT_PUBLIC_TANGLER_URL


WORKDIR /app
COPY ./src ./src
# COPY ./src/** ./src/
COPY ./public ./public
COPY ./lib ./lib
COPY ./components ./components
COPY ./utils ./utils
COPY *.* .

RUN npm install
RUN npm run build

EXPOSE 80
CMD ["npm", "run", "start"]